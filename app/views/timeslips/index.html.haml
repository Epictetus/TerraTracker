- content_for(:title, 'Timeslips')
.row
  .span2
    .area= render :partial => "shared/sidebar"
  .span9
    .area
      %h1 Timeslips
      .timeslips-group
        .btn-group
          = link_to "/timeslips/#{@previous.year}/#{@previous.month}/#{@previous.day}?view=#{params[:view]}", :class => "btn" do
            %i.icon-chevron-left
          = link_to timeslips_path, :class => "btn" do
            - if params[:view] == "day"
              = "#{@date.strftime("%A %e %b %Y")}"
            - else
              = "#{@timeslips.keys.first} - #{@timeslips.keys.last}"
          = link_to "/timeslips/#{@next.year}/#{@next.month}/#{@next.day}?view=#{params[:view]}", :class => "btn" do
            %i.icon-chevron-right
        .btn-group
          = link_to "Entire Week", "/timeslips/#{@date.year}/#{@date.month}/#{@date.day}", :class => "btn", :id => "week"
          = link_to "Single Day", "/timeslips/#{@date.year}/#{@date.month}/#{@date.day}?view=day", :class => "btn", :id => "day"
      %br
      %table.table.table-striped
        - @timeslips.each do |date, timeslips|
        - @hours = 0
          %thead
            %th= date
            - if timeslips.count == 0
              %th
              %th
              %th
              %th
              %th
            - else
              %th Project
              %th Task
              %th Hours
              %th Comment
              %th
            - timeslips.each do |t|
              - @hours += t.hours if t.hours != nil
              %tr
                %td= t.user
                %td= t.project
                %td= t.task.name
                %td= number_with_precision(t.hours, :precision => 2)
                %td= t.comment
                %td
                  %a.btn{ :href => edit_timeslip_path(t) }
                    %i.icon-pencil
                    Edit
                  %a.btn.btn-danger{ 'data-method' => :delete, 'data-confirm' => 'Are you sure?', :href => timeslip_path(t) }
                    %i.icon-trash.icon-white
                    Delete
          - if timeslips.count > 0
            %tr
              %td
              %td
              %td
                %b Total Hours:
              %td
                %b= @hours
              %td
              %td
      %hr
      %a.btn.btn-primary{ :href => new_timeslip_path }
        %i.icon-plus.icon-white
        Add Timeslip

:javascript
  var view = "#{params[:view]}"
  if (view == "day") {
    $("#day").addClass("disabled")
    $("#day").removeAttr("href")
  } else {
    $("#week").addClass("disabled")
    $("#week").removeAttr("href")
  }